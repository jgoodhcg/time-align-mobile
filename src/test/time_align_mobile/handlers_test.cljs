(ns time-align-mobile.handlers-test
  (:require [time-align-mobile.handlers :as handlers]
            [time-align-mobile.helpers :refer [deep-merge]]
            [time-align-mobile.db :as db :refer [app-db]]))

(js/test "example test"
         #(-> (str "x")
              (js/expect)
              (.toBe "x")))

(js/test "handler select-next-or-prev-period generated test" #(-> (handlers/select-next-or-prev-period {:db {:active-filter nil, :time-navigators {:day #inst "2019-10-03T22:52:24.445-00:00", :calendar #inst "2019-10-03T22:52:24.445-00:00", :report #inst "2019-10-03T22:52:24.445-00:00"}, :now #inst "2019-10-03T22:53:24.602-00:00", :config {:auto-log-time-align true, :pixel-to-minute-ratio {:default 0.5, :current 0.5}}, :filters [{:id #uuid "bbc34081-38d4-4d4f-ab19-a7cef18c1212", :label "sort by bucket label", :created #inst "2019-10-03T22:52:24.445-00:00", :compatible [:period :template], :last-edited #inst "2019-10-03T22:52:24.445-00:00", :sort {:path [:bucket-label], :ascending true}, :predicates []} {:id #uuid "aad94081-38d4-4d4f-ab19-a7cef18c1299", :label "sort by label", :created #inst "2019-10-03T22:52:24.445-00:00", :compatible [:bucket :filter :period :template], :last-edited #inst "2019-10-03T22:52:24.445-00:00", :sort {:path [:label], :ascending true}, :predicates []} {:id #uuid "cccc4081-38d4-4d4f-ab19-a7cef18c4444", :label "time align bucket filter", :created #inst "2019-10-03T22:52:24.445-00:00", :compatible [:period :template], :last-edited #inst "2019-10-03T22:52:24.445-00:00", :sort nil, :predicates [{:path [:bucket-id], :value "a7396f81-38d4-4d4f-ab19-a7cef18c4ea2", :negate false}]} {:id #uuid "79d85cf3-b664-42c0-b8cf-2dc4fa9f520a", :label "new bucket bucket filter", :created #inst "2019-10-03T22:53:01.384-00:00", :last-edited #inst "2019-10-03T22:53:01.384-00:00", :compatible [:period :template], :sort {:path [:start], :ascending true}, :predicates [{:path [:bucket-id], :negate false, :value "3e5fb39c-ec07-4660-8b3b-95acaedd2b6f"}]}], :patterns [{:id #uuid "ffa49881-38d4-4d4f-ab19-a7cef18c4465", :label "an example pattern", :created #inst "2019-10-03T22:52:24.445-00:00", :last-edited #inst "2019-10-03T22:53:32.936-00:00", :data {}, :templates [{:planned true, :start 36504239, :created #inst "2019-10-03T22:53:31.183-00:00", :stop 40104239, :label "", :id #uuid "2c1c193c-51c9-4b0c-a849-34f1387cea7e", :last-edited #inst "2019-10-03T22:53:31.183-00:00", :bucket-id #uuid "3e5fb39c-ec07-4660-8b3b-95acaedd2b6f", :data {}}]}], :navigation {:current-screen :day, :params nil}, :period-in-play-id nil, :buckets {#uuid "3e5fb39c-ec07-4660-8b3b-95acaedd2b6f" {:id #uuid "3e5fb39c-ec07-4660-8b3b-95acaedd2b6f", :label "new bucket", :created #inst "2019-10-03T22:52:53.711-00:00", :last-edited #inst "2019-10-03T22:52:59.719-00:00", :data {}, :color "#ff1122", :templates nil, :periods {#uuid "49f088d0-23bc-45c6-a30a-c53bcae5d41a" {:id #uuid "49f088d0-23bc-45c6-a30a-c53bcae5d41a", :created #inst "2019-10-03T22:53:10.372-00:00", :last-edited #inst "2019-10-03T22:53:10.372-00:00", :label "", :planned false, :start #inst "2019-10-03T13:33:03.723-00:00", :stop #inst "2019-10-03T14:18:03.723-00:00", :data {}}, #uuid "95e11ad7-5a71-4510-9fdd-63cbd4256fe4" {:id #uuid "95e11ad7-5a71-4510-9fdd-63cbd4256fe4", :planned false, :start #inst "2019-10-06T20:37:02.394-00:00", :stop #inst "2019-10-06T20:37:03.394-00:00", :created #inst "2019-10-06T20:37:02.394-00:00", :last-edited #inst "2019-10-06T20:37:02.394-00:00", :label "", :data {}}, #uuid "428513d3-b105-4adc-8b25-96de37dd3c0d" {:id #uuid "428513d3-b105-4adc-8b25-96de37dd3c0d", :created #inst "2019-10-06T21:01:10.978-00:00", :last-edited #inst "2019-10-06T21:01:10.978-00:00", :label "", :planned false, :start #inst "2019-10-03T15:23:48.878-00:00", :stop #inst "2019-10-03T16:08:48.878-00:00", :data {}}}}}, :selection {:period {:movement {:bucket-id nil, :period-id nil}, :edit {:period-id #uuid "428513d3-b105-4adc-8b25-96de37dd3c0d", :bucket-id #uuid "3e5fb39c-ec07-4660-8b3b-95acaedd2b6f"}}, :template {:movement {:bucket-id nil, :template-id nil}, :edit {:bucket-id nil, :template-id nil}}}, :forms {:bucket-form {:id #uuid "3e5fb39c-ec07-4660-8b3b-95acaedd2b6f", :label "new bucket", :created #inst "2019-10-03T22:52:53.711-00:00", :last-edited #inst "2019-10-03T22:52:59.719-00:00", :data "{}", :color "#ff1122", :templates nil, :periods nil}, :period-form {:planned false, :bucket-label "new bucket", :start #inst "2019-10-03T15:23:48.878-00:00", :created #inst "2019-10-06T21:01:10.978-00:00", :stop #inst "2019-10-03T16:08:48.878-00:00", :label "", :id #uuid "428513d3-b105-4adc-8b25-96de37dd3c0d", :last-edited #inst "2019-10-06T21:01:10.978-00:00", :bucket-id #uuid "3e5fb39c-ec07-4660-8b3b-95acaedd2b6f", :bucket-color "#ff1122", :data "{}"}, :pattern-form {:id #uuid "ffa49881-38d4-4d4f-ab19-a7cef18c4465", :label "an example pattern", :created #inst "2019-10-03T22:52:24.445-00:00", :last-edited #inst "2019-10-03T22:53:32.936-00:00", :data "{}", :templates [{:planned true, :start 36504239, :created #inst "2019-10-03T22:53:31.183-00:00", :stop 40104239, :label "", :id #uuid "2c1c193c-51c9-4b0c-a849-34f1387cea7e", :last-edited #inst "2019-10-03T22:53:31.183-00:00", :bucket-id #uuid "3e5fb39c-ec07-4660-8b3b-95acaedd2b6f", :data {}}]}, :template-form nil, :filter-form nil}, :selected-template nil}}[:select-next-or-prev-period :prev])(str)(js/expect) (.toBe (->> {:db {:active-filter nil, :time-navigators {:day #inst "2019-10-03T22:52:24.445-00:00", :calendar #inst "2019-10-03T22:52:24.445-00:00", :report #inst "2019-10-03T22:52:24.445-00:00"}, :now #inst "2019-10-03T22:53:24.602-00:00", :config {:auto-log-time-align true, :pixel-to-minute-ratio {:default 0.5, :current 0.5}}, :filters [{:id #uuid "bbc34081-38d4-4d4f-ab19-a7cef18c1212", :label "sort by bucket label", :created #inst "2019-10-03T22:52:24.445-00:00", :compatible [:period :template], :last-edited #inst "2019-10-03T22:52:24.445-00:00", :sort {:path [:bucket-label], :ascending true}, :predicates []} {:id #uuid "aad94081-38d4-4d4f-ab19-a7cef18c1299", :label "sort by label", :created #inst "2019-10-03T22:52:24.445-00:00", :compatible [:bucket :filter :period :template], :last-edited #inst "2019-10-03T22:52:24.445-00:00", :sort {:path [:label], :ascending true}, :predicates []} {:id #uuid "cccc4081-38d4-4d4f-ab19-a7cef18c4444", :label "time align bucket filter", :created #inst "2019-10-03T22:52:24.445-00:00", :compatible [:period :template], :last-edited #inst "2019-10-03T22:52:24.445-00:00", :sort nil, :predicates [{:path [:bucket-id], :value "a7396f81-38d4-4d4f-ab19-a7cef18c4ea2", :negate false}]} {:id #uuid "79d85cf3-b664-42c0-b8cf-2dc4fa9f520a", :label "new bucket bucket filter", :created #inst "2019-10-03T22:53:01.384-00:00", :last-edited #inst "2019-10-03T22:53:01.384-00:00", :compatible [:period :template], :sort {:path [:start], :ascending true}, :predicates [{:path [:bucket-id], :negate false, :value "3e5fb39c-ec07-4660-8b3b-95acaedd2b6f"}]}], :patterns [{:id #uuid "ffa49881-38d4-4d4f-ab19-a7cef18c4465", :label "an example pattern", :created #inst "2019-10-03T22:52:24.445-00:00", :last-edited #inst "2019-10-03T22:53:32.936-00:00", :data {}, :templates [{:planned true, :start 36504239, :created #inst "2019-10-03T22:53:31.183-00:00", :stop 40104239, :label "", :id #uuid "2c1c193c-51c9-4b0c-a849-34f1387cea7e", :last-edited #inst "2019-10-03T22:53:31.183-00:00", :bucket-id #uuid "3e5fb39c-ec07-4660-8b3b-95acaedd2b6f", :data {}}]}], :navigation {:current-screen :day, :params nil}, :period-in-play-id nil, :buckets {#uuid "3e5fb39c-ec07-4660-8b3b-95acaedd2b6f" {:id #uuid "3e5fb39c-ec07-4660-8b3b-95acaedd2b6f", :label "new bucket", :created #inst "2019-10-03T22:52:53.711-00:00", :last-edited #inst "2019-10-03T22:52:59.719-00:00", :data {}, :color "#ff1122", :templates nil, :periods {#uuid "49f088d0-23bc-45c6-a30a-c53bcae5d41a" {:id #uuid "49f088d0-23bc-45c6-a30a-c53bcae5d41a", :created #inst "2019-10-03T22:53:10.372-00:00", :last-edited #inst "2019-10-03T22:53:10.372-00:00", :label "", :planned false, :start #inst "2019-10-03T13:33:03.723-00:00", :stop #inst "2019-10-03T14:18:03.723-00:00", :data {}}, #uuid "95e11ad7-5a71-4510-9fdd-63cbd4256fe4" {:id #uuid "95e11ad7-5a71-4510-9fdd-63cbd4256fe4", :planned false, :start #inst "2019-10-06T20:37:02.394-00:00", :stop #inst "2019-10-06T20:37:03.394-00:00", :created #inst "2019-10-06T20:37:02.394-00:00", :last-edited #inst "2019-10-06T20:37:02.394-00:00", :label "", :data {}}, #uuid "428513d3-b105-4adc-8b25-96de37dd3c0d" {:id #uuid "428513d3-b105-4adc-8b25-96de37dd3c0d", :created #inst "2019-10-06T21:01:10.978-00:00", :last-edited #inst "2019-10-06T21:01:10.978-00:00", :label "", :planned false, :start #inst "2019-10-03T15:23:48.878-00:00", :stop #inst "2019-10-03T16:08:48.878-00:00", :data {}}}}}, :selection {:period {:movement {:bucket-id nil, :period-id nil}, :edit {:period-id #uuid "428513d3-b105-4adc-8b25-96de37dd3c0d", :bucket-id #uuid "3e5fb39c-ec07-4660-8b3b-95acaedd2b6f"}}, :template {:movement {:bucket-id nil, :template-id nil}, :edit {:bucket-id nil, :template-id nil}}}, :forms {:bucket-form {:id #uuid "3e5fb39c-ec07-4660-8b3b-95acaedd2b6f", :label "new bucket", :created #inst "2019-10-03T22:52:53.711-00:00", :last-edited #inst "2019-10-03T22:52:59.719-00:00", :data "{}", :color "#ff1122", :templates nil, :periods nil}, :period-form {:planned false, :bucket-label "new bucket", :start #inst "2019-10-03T15:23:48.878-00:00", :created #inst "2019-10-06T21:01:10.978-00:00", :stop #inst "2019-10-03T16:08:48.878-00:00", :label "", :id #uuid "428513d3-b105-4adc-8b25-96de37dd3c0d", :last-edited #inst "2019-10-06T21:01:10.978-00:00", :bucket-id #uuid "3e5fb39c-ec07-4660-8b3b-95acaedd2b6f", :bucket-color "#ff1122", :data "{}"}, :pattern-form {:id #uuid "ffa49881-38d4-4d4f-ab19-a7cef18c4465", :label "an example pattern", :created #inst "2019-10-03T22:52:24.445-00:00", :last-edited #inst "2019-10-03T22:53:32.936-00:00", :data "{}", :templates [{:planned true, :start 36504239, :created #inst "2019-10-03T22:53:31.183-00:00", :stop 40104239, :label "", :id #uuid "2c1c193c-51c9-4b0c-a849-34f1387cea7e", :last-edited #inst "2019-10-03T22:53:31.183-00:00", :bucket-id #uuid "3e5fb39c-ec07-4660-8b3b-95acaedd2b6f", :data {}}]}, :template-form nil, :filter-form nil}, :selected-template nil}, :dispatch [:select-period-edit {:bucket-id #uuid "3e5fb39c-ec07-4660-8b3b-95acaedd2b6f", :period-id #uuid "49f088d0-23bc-45c6-a30a-c53bcae5d41a"}]}(str)))))

(js/test "handler select-next-or-prev-template-in-form generated test" #(-> (handlers/select-next-or-prev-template-in-form {:db {:active-filter nil, :time-navigators {:day #inst "2019-10-03T22:52:24.445-00:00", :calendar #inst "2019-10-03T22:52:24.445-00:00", :report #inst "2019-10-03T22:52:24.445-00:00"}, :now #inst "2019-10-03T22:53:24.602-00:00", :config {:auto-log-time-align true, :pixel-to-minute-ratio {:default 0.5, :current 0.5}}, :filters [{:id #uuid "bbc34081-38d4-4d4f-ab19-a7cef18c1212", :label "sort by bucket label", :created #inst "2019-10-03T22:52:24.445-00:00", :compatible [:period :template], :last-edited #inst "2019-10-03T22:52:24.445-00:00", :sort {:path [:bucket-label], :ascending true}, :predicates []} {:id #uuid "aad94081-38d4-4d4f-ab19-a7cef18c1299", :label "sort by label", :created #inst "2019-10-03T22:52:24.445-00:00", :compatible [:bucket :filter :period :template], :last-edited #inst "2019-10-03T22:52:24.445-00:00", :sort {:path [:label], :ascending true}, :predicates []} {:id #uuid "cccc4081-38d4-4d4f-ab19-a7cef18c4444", :label "time align bucket filter", :created #inst "2019-10-03T22:52:24.445-00:00", :compatible [:period :template], :last-edited #inst "2019-10-03T22:52:24.445-00:00", :sort nil, :predicates [{:path [:bucket-id], :value "a7396f81-38d4-4d4f-ab19-a7cef18c4ea2", :negate false}]} {:id #uuid "79d85cf3-b664-42c0-b8cf-2dc4fa9f520a", :label "new bucket bucket filter", :created #inst "2019-10-03T22:53:01.384-00:00", :last-edited #inst "2019-10-03T22:53:01.384-00:00", :compatible [:period :template], :sort {:path [:start], :ascending true}, :predicates [{:path [:bucket-id], :negate false, :value "3e5fb39c-ec07-4660-8b3b-95acaedd2b6f"}]}], :patterns [{:id #uuid "ffa49881-38d4-4d4f-ab19-a7cef18c4465", :label "an example pattern", :created #inst "2019-10-03T22:52:24.445-00:00", :last-edited #inst "2019-10-03T22:53:32.936-00:00", :data {}, :templates [{:planned true, :start 36504239, :created #inst "2019-10-03T22:53:31.183-00:00", :stop 40104239, :label "", :id #uuid "2c1c193c-51c9-4b0c-a849-34f1387cea7e", :last-edited #inst "2019-10-03T22:53:31.183-00:00", :bucket-id #uuid "3e5fb39c-ec07-4660-8b3b-95acaedd2b6f", :data {}}]}], :navigation {:current-screen :pattern-planning, :params {:do-not-load-form true}}, :period-in-play-id nil, :buckets {#uuid "3e5fb39c-ec07-4660-8b3b-95acaedd2b6f" {:id #uuid "3e5fb39c-ec07-4660-8b3b-95acaedd2b6f", :label "new bucket", :created #inst "2019-10-03T22:52:53.711-00:00", :last-edited #inst "2019-10-03T22:52:59.719-00:00", :data {}, :color "#ff1122", :templates nil, :periods {#uuid "49f088d0-23bc-45c6-a30a-c53bcae5d41a" {:id #uuid "49f088d0-23bc-45c6-a30a-c53bcae5d41a", :created #inst "2019-10-03T22:53:10.372-00:00", :last-edited #inst "2019-10-03T22:53:10.372-00:00", :label "", :planned false, :start #inst "2019-10-03T13:33:03.723-00:00", :stop #inst "2019-10-03T14:18:03.723-00:00", :data {}}, #uuid "95e11ad7-5a71-4510-9fdd-63cbd4256fe4" {:id #uuid "95e11ad7-5a71-4510-9fdd-63cbd4256fe4", :planned false, :start #inst "2019-10-06T20:37:02.394-00:00", :stop #inst "2019-10-06T20:37:03.394-00:00", :created #inst "2019-10-06T20:37:02.394-00:00", :last-edited #inst "2019-10-06T20:37:02.394-00:00", :label "", :data {}}, #uuid "428513d3-b105-4adc-8b25-96de37dd3c0d" {:id #uuid "428513d3-b105-4adc-8b25-96de37dd3c0d", :created #inst "2019-10-06T21:01:10.978-00:00", :last-edited #inst "2019-10-06T21:01:10.978-00:00", :label "", :planned false, :start #inst "2019-10-03T15:23:48.878-00:00", :stop #inst "2019-10-03T16:08:48.878-00:00", :data {}}}}}, :selection {:period {:movement {:bucket-id nil, :period-id nil}, :edit {:period-id nil, :bucket-id nil}}, :template {:movement {:bucket-id nil, :template-id nil}, :edit {:bucket-id #uuid "3e5fb39c-ec07-4660-8b3b-95acaedd2b6f", :template-id #uuid "7e3da0ff-f386-418b-9060-668262166000"}}}, :forms {:bucket-form {:id #uuid "3e5fb39c-ec07-4660-8b3b-95acaedd2b6f", :label "new bucket", :created #inst "2019-10-03T22:52:53.711-00:00", :last-edited #inst "2019-10-03T22:52:59.719-00:00", :data "{}", :color "#ff1122", :templates nil, :periods nil}, :period-form {:planned false, :bucket-label "new bucket", :start #inst "2019-10-03T13:33:03.723-00:00", :created #inst "2019-10-03T22:53:10.372-00:00", :stop #inst "2019-10-03T14:18:03.723-00:00", :label "", :id #uuid "49f088d0-23bc-45c6-a30a-c53bcae5d41a", :last-edited #inst "2019-10-03T22:53:10.372-00:00", :bucket-id #uuid "3e5fb39c-ec07-4660-8b3b-95acaedd2b6f", :bucket-color "#ff1122", :data "{}"}, :pattern-form {:id #uuid "ffa49881-38d4-4d4f-ab19-a7cef18c4465", :label "an example pattern", :created #inst "2019-10-03T22:52:24.445-00:00", :last-edited #inst "2019-10-03T22:53:32.936-00:00", :data "{}", :templates [{:planned true, :start 36504239, :created #inst "2019-10-03T22:53:31.183-00:00", :stop 40104239, :label "", :id #uuid "2c1c193c-51c9-4b0c-a849-34f1387cea7e", :last-edited #inst "2019-10-03T22:53:31.183-00:00", :bucket-id #uuid "3e5fb39c-ec07-4660-8b3b-95acaedd2b6f", :data {}} {:planned true, :start 45871333, :created #inst "2019-10-06T21:03:25.283-00:00", :stop 49471333, :label "", :id #uuid "7e3da0ff-f386-418b-9060-668262166000", :last-edited #inst "2019-10-06T21:03:25.283-00:00", :bucket-id #uuid "3e5fb39c-ec07-4660-8b3b-95acaedd2b6f", :data {}}]}, :template-form {:planned true, :bucket-label "new bucket", :start 45871333, :pattern-id #uuid "ffa49881-38d4-4d4f-ab19-a7cef18c4465", :created #inst "2019-10-06T21:03:25.283-00:00", :stop 49471333, :label "", :id #uuid "7e3da0ff-f386-418b-9060-668262166000", :last-edited #inst "2019-10-06T21:03:25.283-00:00", :bucket-id #uuid "3e5fb39c-ec07-4660-8b3b-95acaedd2b6f", :bucket-color "#ff1122", :data "{}"}, :filter-form nil}, :selected-template nil}}[:select-next-or-prev-template-in-form :prev])(str)(js/expect) (.toBe (->> {:db {:active-filter nil, :time-navigators {:day #inst "2019-10-03T22:52:24.445-00:00", :calendar #inst "2019-10-03T22:52:24.445-00:00", :report #inst "2019-10-03T22:52:24.445-00:00"}, :now #inst "2019-10-03T22:53:24.602-00:00", :config {:auto-log-time-align true, :pixel-to-minute-ratio {:default 0.5, :current 0.5}}, :filters [{:id #uuid "bbc34081-38d4-4d4f-ab19-a7cef18c1212", :label "sort by bucket label", :created #inst "2019-10-03T22:52:24.445-00:00", :compatible [:period :template], :last-edited #inst "2019-10-03T22:52:24.445-00:00", :sort {:path [:bucket-label], :ascending true}, :predicates []} {:id #uuid "aad94081-38d4-4d4f-ab19-a7cef18c1299", :label "sort by label", :created #inst "2019-10-03T22:52:24.445-00:00", :compatible [:bucket :filter :period :template], :last-edited #inst "2019-10-03T22:52:24.445-00:00", :sort {:path [:label], :ascending true}, :predicates []} {:id #uuid "cccc4081-38d4-4d4f-ab19-a7cef18c4444", :label "time align bucket filter", :created #inst "2019-10-03T22:52:24.445-00:00", :compatible [:period :template], :last-edited #inst "2019-10-03T22:52:24.445-00:00", :sort nil, :predicates [{:path [:bucket-id], :value "a7396f81-38d4-4d4f-ab19-a7cef18c4ea2", :negate false}]} {:id #uuid "79d85cf3-b664-42c0-b8cf-2dc4fa9f520a", :label "new bucket bucket filter", :created #inst "2019-10-03T22:53:01.384-00:00", :last-edited #inst "2019-10-03T22:53:01.384-00:00", :compatible [:period :template], :sort {:path [:start], :ascending true}, :predicates [{:path [:bucket-id], :negate false, :value "3e5fb39c-ec07-4660-8b3b-95acaedd2b6f"}]}], :patterns [{:id #uuid "ffa49881-38d4-4d4f-ab19-a7cef18c4465", :label "an example pattern", :created #inst "2019-10-03T22:52:24.445-00:00", :last-edited #inst "2019-10-03T22:53:32.936-00:00", :data {}, :templates [{:planned true, :start 36504239, :created #inst "2019-10-03T22:53:31.183-00:00", :stop 40104239, :label "", :id #uuid "2c1c193c-51c9-4b0c-a849-34f1387cea7e", :last-edited #inst "2019-10-03T22:53:31.183-00:00", :bucket-id #uuid "3e5fb39c-ec07-4660-8b3b-95acaedd2b6f", :data {}}]}], :navigation {:current-screen :pattern-planning, :params {:do-not-load-form true}}, :period-in-play-id nil, :buckets {#uuid "3e5fb39c-ec07-4660-8b3b-95acaedd2b6f" {:id #uuid "3e5fb39c-ec07-4660-8b3b-95acaedd2b6f", :label "new bucket", :created #inst "2019-10-03T22:52:53.711-00:00", :last-edited #inst "2019-10-03T22:52:59.719-00:00", :data {}, :color "#ff1122", :templates nil, :periods {#uuid "49f088d0-23bc-45c6-a30a-c53bcae5d41a" {:id #uuid "49f088d0-23bc-45c6-a30a-c53bcae5d41a", :created #inst "2019-10-03T22:53:10.372-00:00", :last-edited #inst "2019-10-03T22:53:10.372-00:00", :label "", :planned false, :start #inst "2019-10-03T13:33:03.723-00:00", :stop #inst "2019-10-03T14:18:03.723-00:00", :data {}}, #uuid "95e11ad7-5a71-4510-9fdd-63cbd4256fe4" {:id #uuid "95e11ad7-5a71-4510-9fdd-63cbd4256fe4", :planned false, :start #inst "2019-10-06T20:37:02.394-00:00", :stop #inst "2019-10-06T20:37:03.394-00:00", :created #inst "2019-10-06T20:37:02.394-00:00", :last-edited #inst "2019-10-06T20:37:02.394-00:00", :label "", :data {}}, #uuid "428513d3-b105-4adc-8b25-96de37dd3c0d" {:id #uuid "428513d3-b105-4adc-8b25-96de37dd3c0d", :created #inst "2019-10-06T21:01:10.978-00:00", :last-edited #inst "2019-10-06T21:01:10.978-00:00", :label "", :planned false, :start #inst "2019-10-03T15:23:48.878-00:00", :stop #inst "2019-10-03T16:08:48.878-00:00", :data {}}}}}, :selection {:period {:movement {:bucket-id nil, :period-id nil}, :edit {:period-id nil, :bucket-id nil}}, :template {:movement {:bucket-id nil, :template-id nil}, :edit {:bucket-id #uuid "3e5fb39c-ec07-4660-8b3b-95acaedd2b6f", :template-id #uuid "7e3da0ff-f386-418b-9060-668262166000"}}}, :forms {:bucket-form {:id #uuid "3e5fb39c-ec07-4660-8b3b-95acaedd2b6f", :label "new bucket", :created #inst "2019-10-03T22:52:53.711-00:00", :last-edited #inst "2019-10-03T22:52:59.719-00:00", :data "{}", :color "#ff1122", :templates nil, :periods nil}, :period-form {:planned false, :bucket-label "new bucket", :start #inst "2019-10-03T13:33:03.723-00:00", :created #inst "2019-10-03T22:53:10.372-00:00", :stop #inst "2019-10-03T14:18:03.723-00:00", :label "", :id #uuid "49f088d0-23bc-45c6-a30a-c53bcae5d41a", :last-edited #inst "2019-10-03T22:53:10.372-00:00", :bucket-id #uuid "3e5fb39c-ec07-4660-8b3b-95acaedd2b6f", :bucket-color "#ff1122", :data "{}"}, :pattern-form {:id #uuid "ffa49881-38d4-4d4f-ab19-a7cef18c4465", :label "an example pattern", :created #inst "2019-10-03T22:52:24.445-00:00", :last-edited #inst "2019-10-03T22:53:32.936-00:00", :data "{}", :templates [{:planned true, :start 36504239, :created #inst "2019-10-03T22:53:31.183-00:00", :stop 40104239, :label "", :id #uuid "2c1c193c-51c9-4b0c-a849-34f1387cea7e", :last-edited #inst "2019-10-03T22:53:31.183-00:00", :bucket-id #uuid "3e5fb39c-ec07-4660-8b3b-95acaedd2b6f", :data {}} {:planned true, :start 45871333, :created #inst "2019-10-06T21:03:25.283-00:00", :stop 49471333, :label "", :id #uuid "7e3da0ff-f386-418b-9060-668262166000", :last-edited #inst "2019-10-06T21:03:25.283-00:00", :bucket-id #uuid "3e5fb39c-ec07-4660-8b3b-95acaedd2b6f", :data {}}]}, :template-form {:planned true, :bucket-label "new bucket", :start 45871333, :pattern-id #uuid "ffa49881-38d4-4d4f-ab19-a7cef18c4465", :created #inst "2019-10-06T21:03:25.283-00:00", :stop 49471333, :label "", :id #uuid "7e3da0ff-f386-418b-9060-668262166000", :last-edited #inst "2019-10-06T21:03:25.283-00:00", :bucket-id #uuid "3e5fb39c-ec07-4660-8b3b-95acaedd2b6f", :bucket-color "#ff1122", :data "{}"}, :filter-form nil}, :selected-template nil}, :dispatch [:select-template-edit {:template-id #uuid "2c1c193c-51c9-4b0c-a849-34f1387cea7e", :bucket-id #uuid "3e5fb39c-ec07-4660-8b3b-95acaedd2b6f"}]}(str)))))

(js/test "handler navigate-to generated test" #(-> (handlers/navigate-to {:db {:active-filter nil, :time-navigators {:day #inst "2019-10-06T21:14:34.652-00:00", :calendar #inst "2019-10-06T21:14:34.652-00:00", :report #inst "2019-10-06T21:14:34.652-00:00"}, :now #inst "2019-10-06T21:14:34.652-00:00", :config {:auto-log-time-align true, :pixel-to-minute-ratio {:default 0.5, :current 0.5}}, :filters [{:id #uuid "bbc34081-38d4-4d4f-ab19-a7cef18c1212", :label "sort by bucket label", :created #inst "2019-10-06T21:14:34.652-00:00", :compatible [:period :template], :last-edited #inst "2019-10-06T21:14:34.652-00:00", :sort {:path [:bucket-label], :ascending true}, :predicates []} {:id #uuid "aad94081-38d4-4d4f-ab19-a7cef18c1299", :label "sort by label", :created #inst "2019-10-06T21:14:34.652-00:00", :compatible [:bucket :filter :period :template], :last-edited #inst "2019-10-06T21:14:34.652-00:00", :sort {:path [:label], :ascending true}, :predicates []} {:id #uuid "cccc4081-38d4-4d4f-ab19-a7cef18c4444", :label "time align bucket filter", :created #inst "2019-10-06T21:14:34.652-00:00", :compatible [:period :template], :last-edited #inst "2019-10-06T21:14:34.652-00:00", :sort nil, :predicates [{:path [:bucket-id], :value "a7396f81-38d4-4d4f-ab19-a7cef18c4ea2", :negate false}]}], :patterns [{:id #uuid "ffa49881-38d4-4d4f-ab19-a7cef18c4465", :label "an example pattern", :created #inst "2019-10-06T21:14:34.652-00:00", :last-edited #inst "2019-10-06T21:14:34.652-00:00", :data {}, :templates []}], :navigation {:current-screen :day, :params nil}, :period-in-play-id nil, :buckets {}, :selection {:period {:movement {:bucket-id nil, :period-id nil}, :edit {:period-id nil, :bucket-id nil}}, :template {:movement {:bucket-id nil, :template-id nil}, :edit {:bucket-id nil, :template-id nil}}}, :forms {:bucket-form nil, :period-form nil, :pattern-form nil, :template-form nil, :filter-form nil}}}[:navigate-to {:current-screen :calendar, :params nil}])(str)(js/expect) (.toBe (->> {:db {:active-filter nil, :time-navigators {:day #inst "2019-10-06T21:14:34.652-00:00", :calendar #inst "2019-10-06T21:14:34.652-00:00", :report #inst "2019-10-06T21:14:34.652-00:00"}, :now #inst "2019-10-06T21:14:34.652-00:00", :config {:auto-log-time-align true, :pixel-to-minute-ratio {:default 0.5, :current 0.5}}, :filters [{:id #uuid "bbc34081-38d4-4d4f-ab19-a7cef18c1212", :label "sort by bucket label", :created #inst "2019-10-06T21:14:34.652-00:00", :compatible [:period :template], :last-edited #inst "2019-10-06T21:14:34.652-00:00", :sort {:path [:bucket-label], :ascending true}, :predicates []} {:id #uuid "aad94081-38d4-4d4f-ab19-a7cef18c1299", :label "sort by label", :created #inst "2019-10-06T21:14:34.652-00:00", :compatible [:bucket :filter :period :template], :last-edited #inst "2019-10-06T21:14:34.652-00:00", :sort {:path [:label], :ascending true}, :predicates []} {:id #uuid "cccc4081-38d4-4d4f-ab19-a7cef18c4444", :label "time align bucket filter", :created #inst "2019-10-06T21:14:34.652-00:00", :compatible [:period :template], :last-edited #inst "2019-10-06T21:14:34.652-00:00", :sort nil, :predicates [{:path [:bucket-id], :value "a7396f81-38d4-4d4f-ab19-a7cef18c4ea2", :negate false}]}], :patterns [{:id #uuid "ffa49881-38d4-4d4f-ab19-a7cef18c4465", :label "an example pattern", :created #inst "2019-10-06T21:14:34.652-00:00", :last-edited #inst "2019-10-06T21:14:34.652-00:00", :data {}, :templates []}], :navigation {:current-screen :calendar, :params nil}, :period-in-play-id nil, :buckets {}, :selection {:period {:movement {:bucket-id nil, :period-id nil}, :edit {:period-id nil, :bucket-id nil}}, :template {:movement {:bucket-id nil, :template-id nil}, :edit {:bucket-id nil, :template-id nil}}}, :forms {:bucket-form nil, :period-form nil, :pattern-form nil, :template-form nil, :filter-form nil}}, :save-nav-screen {:current-screen :calendar, :params nil}}(str)))))

(js/test "handler load-bucket-form generated test" #(-> (handlers/load-bucket-form {:active-filter nil, :time-navigators {:day #inst "2019-10-06T21:16:11.522-00:00", :calendar #inst "2019-10-06T21:16:11.522-00:00", :report #inst "2019-10-06T21:16:11.522-00:00"}, :now #inst "2019-10-06T21:16:11.522-00:00", :config {:auto-log-time-align true, :pixel-to-minute-ratio {:default 0.5, :current 0.5}}, :filters [{:id #uuid "bbc34081-38d4-4d4f-ab19-a7cef18c1212", :label "sort by bucket label", :created #inst "2019-10-06T21:16:11.522-00:00", :compatible [:period :template], :last-edited #inst "2019-10-06T21:16:11.522-00:00", :sort {:path [:bucket-label], :ascending true}, :predicates []} {:id #uuid "aad94081-38d4-4d4f-ab19-a7cef18c1299", :label "sort by label", :created #inst "2019-10-06T21:16:11.522-00:00", :compatible [:bucket :filter :period :template], :last-edited #inst "2019-10-06T21:16:11.522-00:00", :sort {:path [:label], :ascending true}, :predicates []} {:id #uuid "cccc4081-38d4-4d4f-ab19-a7cef18c4444", :label "time align bucket filter", :created #inst "2019-10-06T21:16:11.522-00:00", :compatible [:period :template], :last-edited #inst "2019-10-06T21:16:11.522-00:00", :sort nil, :predicates [{:path [:bucket-id], :value "a7396f81-38d4-4d4f-ab19-a7cef18c4ea2", :negate false}]}], :patterns [{:id #uuid "ffa49881-38d4-4d4f-ab19-a7cef18c4465", :label "an example pattern", :created #inst "2019-10-06T21:16:11.522-00:00", :last-edited #inst "2019-10-06T21:16:11.522-00:00", :data {}, :templates []}], :navigation {:current-screen :bucket, :params {:bucket-id #uuid "cd426701-726a-461f-aa11-def21c2ad32e"}}, :period-in-play-id nil, :buckets {#uuid "cd426701-726a-461f-aa11-def21c2ad32e" {:id #uuid "cd426701-726a-461f-aa11-def21c2ad32e", :label "bucket 001", :created #inst "2019-10-06T21:16:21.402-00:00", :last-edited #inst "2019-10-06T21:16:44.329-00:00", :data {}, :color "#6211ff", :templates nil, :periods nil}}, :selection {:period {:movement {:bucket-id nil, :period-id nil}, :edit {:period-id nil, :bucket-id nil}}, :template {:movement {:bucket-id nil, :template-id nil}, :edit {:bucket-id nil, :template-id nil}}}, :forms {:bucket-form {:id #uuid "cd426701-726a-461f-aa11-def21c2ad32e", :label "bucket 001", :created #inst "2019-10-06T21:16:21.402-00:00", :last-edited #inst "2019-10-06T21:16:21.402-00:00", :data "{}", :color "#6211ff", :templates nil, :periods nil}, :period-form nil, :pattern-form nil, :template-form nil, :filter-form nil}}[:load-bucket-form #uuid "cd426701-726a-461f-aa11-def21c2ad32e"])(str)(js/expect) (.toBe (->> {:active-filter nil, :time-navigators {:day #inst "2019-10-06T21:16:11.522-00:00", :calendar #inst "2019-10-06T21:16:11.522-00:00", :report #inst "2019-10-06T21:16:11.522-00:00"}, :now #inst "2019-10-06T21:16:11.522-00:00", :config {:auto-log-time-align true, :pixel-to-minute-ratio {:default 0.5, :current 0.5}}, :filters [{:id #uuid "bbc34081-38d4-4d4f-ab19-a7cef18c1212", :label "sort by bucket label", :created #inst "2019-10-06T21:16:11.522-00:00", :compatible [:period :template], :last-edited #inst "2019-10-06T21:16:11.522-00:00", :sort {:path [:bucket-label], :ascending true}, :predicates []} {:id #uuid "aad94081-38d4-4d4f-ab19-a7cef18c1299", :label "sort by label", :created #inst "2019-10-06T21:16:11.522-00:00", :compatible [:bucket :filter :period :template], :last-edited #inst "2019-10-06T21:16:11.522-00:00", :sort {:path [:label], :ascending true}, :predicates []} {:id #uuid "cccc4081-38d4-4d4f-ab19-a7cef18c4444", :label "time align bucket filter", :created #inst "2019-10-06T21:16:11.522-00:00", :compatible [:period :template], :last-edited #inst "2019-10-06T21:16:11.522-00:00", :sort nil, :predicates [{:path [:bucket-id], :value "a7396f81-38d4-4d4f-ab19-a7cef18c4ea2", :negate false}]}], :patterns [{:id #uuid "ffa49881-38d4-4d4f-ab19-a7cef18c4465", :label "an example pattern", :created #inst "2019-10-06T21:16:11.522-00:00", :last-edited #inst "2019-10-06T21:16:11.522-00:00", :data {}, :templates []}], :navigation {:current-screen :bucket, :params {:bucket-id #uuid "cd426701-726a-461f-aa11-def21c2ad32e"}}, :period-in-play-id nil, :buckets {#uuid "cd426701-726a-461f-aa11-def21c2ad32e" {:id #uuid "cd426701-726a-461f-aa11-def21c2ad32e", :label "bucket 001", :created #inst "2019-10-06T21:16:21.402-00:00", :last-edited #inst "2019-10-06T21:16:44.329-00:00", :data {}, :color "#6211ff", :templates nil, :periods nil}}, :selection {:period {:movement {:bucket-id nil, :period-id nil}, :edit {:period-id nil, :bucket-id nil}}, :template {:movement {:bucket-id nil, :template-id nil}, :edit {:bucket-id nil, :template-id nil}}}, :forms {:bucket-form {:id #uuid "cd426701-726a-461f-aa11-def21c2ad32e", :label "bucket 001", :created #inst "2019-10-06T21:16:21.402-00:00", :last-edited #inst "2019-10-06T21:16:44.329-00:00", :data "{}", :color "#6211ff", :templates nil, :periods nil}, :period-form nil, :pattern-form nil, :template-form nil, :filter-form nil}}(str)))))

(js/test "handler update-bucket-form generated test" #(-> (handlers/update-bucket-form {:active-filter nil, :time-navigators {:day #inst "2019-10-07T23:07:28.825-00:00", :calendar #inst "2019-10-07T23:07:28.825-00:00", :report #inst "2019-10-07T23:07:28.825-00:00"}, :now #inst "2019-10-07T23:07:28.825-00:00", :config {:auto-log-time-align true, :pixel-to-minute-ratio {:default 0.5, :current 0.5}}, :filters [{:id #uuid "bbc34081-38d4-4d4f-ab19-a7cef18c1212", :label "sort by bucket label", :created #inst "2019-10-07T23:07:28.825-00:00", :compatible [:period :template], :last-edited #inst "2019-10-07T23:07:28.825-00:00", :sort {:path [:bucket-label], :ascending true}, :predicates []} {:id #uuid "aad94081-38d4-4d4f-ab19-a7cef18c1299", :label "sort by label", :created #inst "2019-10-07T23:07:28.825-00:00", :compatible [:bucket :filter :period :template], :last-edited #inst "2019-10-07T23:07:28.825-00:00", :sort {:path [:label], :ascending true}, :predicates []} {:id #uuid "cccc4081-38d4-4d4f-ab19-a7cef18c4444", :label "time align bucket filter", :created #inst "2019-10-07T23:07:28.825-00:00", :compatible [:period :template], :last-edited #inst "2019-10-07T23:07:28.825-00:00", :sort nil, :predicates [{:path [:bucket-id], :value "a7396f81-38d4-4d4f-ab19-a7cef18c4ea2", :negate false}]}], :patterns [{:id #uuid "ffa49881-38d4-4d4f-ab19-a7cef18c4465", :label "an example pattern", :created #inst "2019-10-07T23:07:28.825-00:00", :last-edited #inst "2019-10-07T23:07:28.825-00:00", :data {}, :templates []}], :navigation {:current-screen :bucket, :params {:bucket-id #uuid "0e0653d6-de81-4aa4-a873-55f29eda9bcf"}}, :period-in-play-id nil, :buckets {#uuid "0e0653d6-de81-4aa4-a873-55f29eda9bcf" {:id #uuid "0e0653d6-de81-4aa4-a873-55f29eda9bcf", :label "", :created #inst "2019-10-07T23:07:45.129-00:00", :last-edited #inst "2019-10-07T23:07:45.129-00:00", :data {}, :color "#ff1122", :templates nil, :periods nil}}, :selection {:period {:movement {:bucket-id nil, :period-id nil}, :edit {:period-id nil, :bucket-id nil}}, :template {:movement {:bucket-id nil, :template-id nil}, :edit {:bucket-id nil, :template-id nil}}}, :forms {:bucket-form {:id #uuid "0e0653d6-de81-4aa4-a873-55f29eda9bcf", :label "", :created #inst "2019-10-07T23:07:45.129-00:00", :last-edited #inst "2019-10-07T23:07:45.129-00:00", :data "{}", :color "#ff1122", :templates nil, :periods nil}, :period-form nil, :pattern-form nil, :template-form nil, :filter-form nil}}[:update-bucket-form {:label "T", :id #uuid "0e0653d6-de81-4aa4-a873-55f29eda9bcf"}])(str)(js/expect) (.toBe (->> {:active-filter nil, :time-navigators {:day #inst "2019-10-07T23:07:28.825-00:00", :calendar #inst "2019-10-07T23:07:28.825-00:00", :report #inst "2019-10-07T23:07:28.825-00:00"}, :now #inst "2019-10-07T23:07:28.825-00:00", :config {:auto-log-time-align true, :pixel-to-minute-ratio {:default 0.5, :current 0.5}}, :filters [{:id #uuid "bbc34081-38d4-4d4f-ab19-a7cef18c1212", :label "sort by bucket label", :created #inst "2019-10-07T23:07:28.825-00:00", :compatible [:period :template], :last-edited #inst "2019-10-07T23:07:28.825-00:00", :sort {:path [:bucket-label], :ascending true}, :predicates []} {:id #uuid "aad94081-38d4-4d4f-ab19-a7cef18c1299", :label "sort by label", :created #inst "2019-10-07T23:07:28.825-00:00", :compatible [:bucket :filter :period :template], :last-edited #inst "2019-10-07T23:07:28.825-00:00", :sort {:path [:label], :ascending true}, :predicates []} {:id #uuid "cccc4081-38d4-4d4f-ab19-a7cef18c4444", :label "time align bucket filter", :created #inst "2019-10-07T23:07:28.825-00:00", :compatible [:period :template], :last-edited #inst "2019-10-07T23:07:28.825-00:00", :sort nil, :predicates [{:path [:bucket-id], :value "a7396f81-38d4-4d4f-ab19-a7cef18c4ea2", :negate false}]}], :patterns [{:id #uuid "ffa49881-38d4-4d4f-ab19-a7cef18c4465", :label "an example pattern", :created #inst "2019-10-07T23:07:28.825-00:00", :last-edited #inst "2019-10-07T23:07:28.825-00:00", :data {}, :templates []}], :navigation {:current-screen :bucket, :params {:bucket-id #uuid "0e0653d6-de81-4aa4-a873-55f29eda9bcf"}}, :period-in-play-id nil, :buckets {#uuid "0e0653d6-de81-4aa4-a873-55f29eda9bcf" {:id #uuid "0e0653d6-de81-4aa4-a873-55f29eda9bcf", :label "", :created #inst "2019-10-07T23:07:45.129-00:00", :last-edited #inst "2019-10-07T23:07:45.129-00:00", :data {}, :color "#ff1122", :templates nil, :periods nil}}, :selection {:period {:movement {:bucket-id nil, :period-id nil}, :edit {:period-id nil, :bucket-id nil}}, :template {:movement {:bucket-id nil, :template-id nil}, :edit {:bucket-id nil, :template-id nil}}}, :forms {:bucket-form {:id #uuid "0e0653d6-de81-4aa4-a873-55f29eda9bcf", :label "T", :created #inst "2019-10-07T23:07:45.129-00:00", :last-edited #inst "2019-10-07T23:07:45.129-00:00", :data "{}", :color "#ff1122", :templates nil, :periods nil}, :period-form nil, :pattern-form nil, :template-form nil, :filter-form nil}}(str)))))
